#CACHE{3600*24*30}
<BOUCLE_principale(RUBRIQUES) {id_rubrique}>
<!DOCTYPE html>
<html lang="#LANG">
<head>
	<title>[(#TITRE|textebrut) - ][(#NOM_SITE_SPIP|textebrut)]</title>
	[<meta name="description" content="(#TEXTE|couper{150}|attribut_html)">]
	[<link rel="alternate" type="application/rss+xml" title="<:syndiquer_rubrique:>" href="(#URL_PAGE{backend} parametre_url{id_rubrique,#ID_RUBRIQUE})">]

	[(#REM) Open Graph Basic Metadata https://ogp.me/#metadata]
    <meta property="og:type" content="website"> [(#REM) https://ogp.me/#no_vertical article, website, book, profile con specifici meta tag]
    <meta property="og:url" content="#URL_RUBRIQUE">
	[<meta property="og:title" content="(#TITRE|couper{80})">]
    [(#REM) minimo 200x200 Use images with a 1.91:1 ratio and minimum recommended dimensions of 1200x630 for optimal clarity across all devices.]
    <BOUCLE_og_image(DOCUMENTS){id_rubrique}{titre=logo_880x300}>
    [<meta property="og:image" content="(#URL_DOCUMENT|image_recadre{16:9,-,center}|extraire_attribut{src}|url_absolue)">]
    </BOUCLE_og_image>
    [<meta property="og:image" content="(#LOGO_RUBRIQUE|image_recadre{16:9,-,center}|extraire_attribut{src}|url_absolue)">]
    <//B_og_image>
	[<meta property="og:description" content="(#DESCRIPTIF|PtoBR|sinon{[(#INTRODUCTION)]})">]
	
	[(#INCLUDE{fond=include/head})]

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/css/autoComplete.min.css">
</head>
<body class="w100 sans-serif bg-white black-80">
	[(#INCLUDE{fond=include/header_full})]

	<main class="w-100">
		<section class="w-100">
			<header class="ph3 ph5-ns pv2">
				<div class="mw8 center">
					<h1 class="f3 tracked ttu lh-title"><BOUCLE_ariane(HIERARCHIE){id_rubrique}><a class="link black-80" href="#URL_RUBRIQUE">[(#TITRE|couper{80})] - </a></BOUCLE_ariane>[(#TITRE|couper{80})]</h1>
					[<p class="f6 tracked ttu lh-title black-50">(#DESCRIPTIF**)</p>]
					<div class="flex flex-wrap">
					<BOUCLE_logo(DOCUMENTS){id_rubrique}{titre=logo_880x300}>
						<div class="w-100">
							[(#URL_DOCUMENT|image_recadre{880,300,center}|inserer_attribut{class,db w-100 h-auto br4})]
							[(#REM)#URL_DOCUMENT|image_recadre{16:9,-,center}|inserer_attribut{class,db w-100 h-auto br4}]
						</div>
						<div class="w-100">
							<div class="mt1">
								<p class="f5 f4-ns lh-copy tj">#TEXTE**</p>
							</div>
						</div>
					</BOUCLE_logo>
						<div class="w-30 w-20-ns">
							[(#LOGO_RUBRIQUE|image_recadre{1:1,-,center}|inserer_attribut{class,db h-auto br4})]
						</div>
						<div class="w-70 w-80-ns">
							<div class="mt1">
								<p class="f5 f4-ns lh-copy tj">#TEXTE**</p>
							</div>
						</div>
					<//B_logo>
					</div>

					<B_sottorubriche>
					<section>
						<p class="f3 tracked ttu lh-title"><:sous_rubriques:></p>
						<div class="flex flex-wrap bl-ns b--black-10">
						<BOUCLE_sottorubriche(RUBRIQUES) {id_parent} {par num titre} {!par date} {doublons}>
							<div class="w-50 w-25-ns pa2 br-ns b--black-10 tc">
								<B_logo_sottorubrica>
								<a class="link black-80" href="#URL_RUBRIQUE">
								<BOUCLE_logo_sottorubrica(DOCUMENTS){id_rubrique}{titre=logo_880x300}>
								[(#URL_DOCUMENT|image_recadre{1:1,-,center}|inserer_attribut{class,db w-100 h-auto br4})]
								</BOUCLE_logo_sottorubrica>
								</a>
								</B_logo_sottorubrica>
								[(#LOGO_RUBRIQUE{#URL_RUBRIQUE}|image_recadre{1:1,-,center}|inserer_attribut{class,db w-100 h-auto br4})]
								<//B_logo_sottorubrica>
								<h2 class="f4 tracked ttu lh-title">#TITRE</a></h2>
								[<p class="lh-copy tj"><a class="link black-80" href="#URL_RUBRIQUE">(#DESCRIPTIF**|sinon{[(#INTRODUCTION|PtoBR)]})</a></p>]
							</div>
						</BOUCLE_sottorubriche>
						</div>
					</section>
					</B_sottorubriche>				
				</div>
			</header>
		</section>
	
		<B_articles>
		<section class="w-100">
			<div class="ph3 ph5-ns pv4">
				<div class="mw8 center">

					<input id="autoComplete" type="text" tabindex="1" placeholder="[(#TITRE)]">

					<p class="f3 tracked ttu lh-title"><:articles_rubrique:></p>
					#ANCRE_PAGINATION
					<div class="cf">
		<BOUCLE_articles(ARTICLES) {id_rubrique} {par titre} {pagination 100}>
						<article class="fl w-100 w-50-m w-25-ns pa3-ns mb4">
							<a class="link dt w-100 bb b--black-10 pb2 mt2 dim blue" href="#URL_ARTICLE">
								<div class="aspect-ratio aspect-ratio--1x1">
									<img style="background-image:url([(#LOGO_ARTICLE_RUBRIQUE|extraire_attribut{src}|url_absolue)]);" class="db bg-center cover aspect-ratio--object br4">
								</div>
								<h2 class="f4 tracked-tight lh-title black-80">[(#TITRE|couper{20,'..'})]</h2>
								<p class="f5 fw4 mt2 black-60">[(#DATE_MODIF|date_relative)]</p>
							</a>
						</article>
		</BOUCLE_articles>
					</div>
					[(#PAGINATION{progettodighe})]
				</div>
			</div>
		</section>
		</B_articles>
	</main>

	[(#INCLUDE{fond=include/footer}{skel=#SQUELETTE})]

	<script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
	<!-- script src="#URL_SITE_SPIP/[(#CHEMIN{asset/js/autocomplete.js})]" type="text/javascript"></script -->
	#URL_SITE_SPIP/[(#URL_PAGE{json}|parametre_url{id_rubrique,#ID_RUBRIQUE})]
	<script type="text/javascript">
			// autoComplete.js on type event emitter
			document.querySelector("#autoComplete").addEventListener("autoComplete", function (event) {
				console.log(event.detail);
			});

			// The autoComplete.js Engine instance creator
			const autoCompletejs = new autoComplete({
				data: {
					src: async function () {
						// Loading placeholder text
						document.querySelector("#autoComplete").setAttribute("placeholder", "Loading...");
						// Fetch External Data Source
						
						const source = await fetch("#URL_SITE_SPIP/#URL_PAGE{json}&id_rubrique=#ID_RUBRIQUE");
						//const source = await fetch("#URL_SITE_SPIP/#URL_PAGE{db}");
						const data = await source.json();
						// Returns Fetched data
						return data;
					},
					key: ["title"],
				},
				trigger: {
					event: ["input", "focusin", "focusout"]
				},
				placeHolder: "[(#TITRE)]",
				searchEngine: "loose",
				highlight: true,
				maxResults: 5,
				resultsList: {
					render: true
				},
				noResults: function () {
					const result = document.createElement("li");
					result.setAttribute("class", "no_result");
					result.setAttribute("tabindex", "1");
					result.innerHTML = "No Results";
					document.querySelector("#autoComplete_list").appendChild(result);
				},
				onSelection: function (feedback) {
					document.querySelector("#autoComplete").blur();
					const selection = feedback.selection.value.food;
					// Render selected choice to selection div
					document.querySelector(".selectionq").innerHTML = selection;
					// Clear Input
					document.querySelector("#autoComplete").value = "";
					// Change placeholder with the selected value
					document.querySelector("#autoComplete").setAttribute("placeholder", selection);
					// Concole log autoComplete data feedback
					console.log(feedback);
				},
			});

			// Toggle results list and other elements
			const action = function (action) {
				const github = document.querySelector(".github-corner");
				const title = document.querySelector("h1");
				const mode = document.querySelector(".mode");
				const selection = document.querySelector(".selection");
				const footer = document.querySelector(".footer");

				if (action === "dim") {
					github.style.opacity = 1;
					title.style.opacity = 1;
					mode.style.opacity = 1;
					selection.style.opacity = 1;
					footer.style.opacity = 1;
				} else {
					github.style.opacity = 0.1;
					title.style.opacity = 0.3;
					mode.style.opacity = 0.2;
					selection.style.opacity = 0.1;
					footer.style.opacity = 0.1;
				}
			};

			// Toggle event for search input
			// showing & hidding results list onfocus / blur
			["focus", "blur"].forEach(function (eventType) {
				const resultsList = document.querySelector("#autoComplete_list");

				document.querySelector("#autoComplete").addEventListener(eventType, function () {
					// Hide results list & show other elemennts
					if (eventType === "blur") {
						action("dim");
						resultsList.style.display = "none";
					} else if (eventType === "focus") {
						// Show results list & hide other elemennts
						action("light");
						resultsList.style.display = "block";
					}
				});
			});
	</script>
</body>
</html>
</BOUCLE_principale>
